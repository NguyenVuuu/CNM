<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n L√Ω S·∫£n Ph·∫©m</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }



    .content {
      padding: 20px;
    }

    .user-info {
      background: #f8f9fa;
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 2px solid #e0e0e0;
    }

    .user-info .welcome {
      color: #333;
      font-weight: 600;
    }

    .user-info .welcome span {
      color: #667eea;
    }

    .btn-logout {
      background: #e74c3c;
      color: white;
      padding: 8px 20px;
      border: none;
      border-radius: 6px;
      font-size: 0.9em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn-logout:hover {
      background: #c0392b;
      transform: translateY(-2px);
    }

    .form-section {
      background: #f8f9fa;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      margin-top: 20px;
    }

    .form-section h2 {
      color: #667eea;
      margin-bottom: 25px;
      font-size: 1.8em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-section h2::before {
      font-size: 1.2em;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 600;
      font-size: 0.95em;
    }

    .form-group input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
      transition: all 0.3s ease;
      background: white;
    }

    .form-group input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .form-group input.error {
      border-color: #e74c3c;
      background: #fff5f5;
    }

    .error-message {
      color: #e74c3c;
      font-size: 0.85em;
      margin-top: 5px;
      display: none;
      animation: slideDown 0.3s ease;
    }

    .error-message.show {
      display: block;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-5px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .btn-submit {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 14px 40px;
      border: none;
      border-radius: 8px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .btn-submit:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-submit:active {
      transform: translateY(0);
    }

    .table-section h2 {
      color: #667eea;
      margin-bottom: 25px;
      font-size: 1.8em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .table-section h2::before {
      font-size: 1.2em;
    }

    .table-wrapper {
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }

    thead {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    th {
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 1em;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    td {
      padding: 15px;
      border-bottom: 1px solid #f0f0f0;
      color: #333;
    }

    tbody tr {
      transition: all 0.2s ease;
    }

    tbody tr:hover {
      background: #f8f9fa;
      transform: scale(1.01);
    }

    tbody tr:last-child td {
      border-bottom: none;
    }

    .action-buttons {
      display: flex;
      gap: 8px;
    }

    .btn-edit, .btn-delete {
      padding: 6px 12px;
      border: none;
      border-radius: 5px;
      font-size: 0.85em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn-edit {
      background: #3498db;
      color: white;
    }

    .btn-edit:hover {
      background: #2980b9;
      transform: translateY(-1px);
    }

    .btn-delete {
      background: #e74c3c;
      color: white;
    }

    .btn-delete:hover {
      background: #c0392b;
      transform: translateY(-1px);
    }

    .empty-state {
      text-align: center;
      padding: 40px;
      color: #999;
      font-size: 1.1em;
    }

    @media (max-width: 768px) {
      .content {
        padding: 20px;
      }

      .header h1 {
        font-size: 1.8em;
      }

      table {
        font-size: 0.9em;
      }

      th, td {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="user-info">
      <div class="welcome">
        Xin ch√†o, <span><%= user.username %></span> (<%= user.email %>)
      </div>
      <a href="/auth/logout" class="btn-logout">ƒêƒÉng Xu·∫•t</a>
    </div>

    <div class="content">
      <div class="form-section">
        <h2>Th√™m S·∫£n Ph·∫©m M·ªõi</h2>
        <form id="productForm" action="/products/add" method="post" novalidate>
          <div class="form-group">
            <label for="name">T√™n S·∫£n Ph·∫©m <span style="color: #e74c3c;">*</span></label>
            <input type="text" id="name" name="name" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m">
            <div class="error-message" id="nameError">Vui l√≤ng nh·∫≠p t√™n s·∫£n ph·∫©m</div>
          </div>

          <div class="form-group">
            <label for="price">Gi√° (VNƒê) <span style="color: #e74c3c;">*</span></label>
            <input type="number" id="price" name="price" placeholder="Nh·∫≠p gi√° s·∫£n ph·∫©m" step="0.01" min="0">
            <div class="error-message" id="priceError">Vui l√≤ng nh·∫≠p gi√° h·ª£p l·ªá (s·ªë d∆∞∆°ng)</div>
          </div>

          <div class="form-group">
            <label for="quantity">S·ªë L∆∞·ª£ng <span style="color: #e74c3c;">*</span></label>
            <input type="number" id="quantity" name="quantity" placeholder="Nh·∫≠p s·ªë l∆∞·ª£ng" min="0">
            <div class="error-message" id="quantityError">Vui l√≤ng nh·∫≠p s·ªë l∆∞·ª£ng h·ª£p l·ªá (s·ªë nguy√™n d∆∞∆°ng)</div>
          </div>

          <button type="submit" class="btn-submit">Th√™m S·∫£n Ph·∫©m</button>
        </form>
      </div>

      <div class="table-section">
        <h2>Danh S√°ch S·∫£n Ph·∫©m</h2>
        <% if (products.length > 0) { %>
          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>T√™n S·∫£n Ph·∫©m</th>
                  <th>Gi√° (VNƒê)</th>
                  <th>S·ªë L∆∞·ª£ng</th>
                  <th>Thao T√°c</th>
                </tr>
              </thead>
              <tbody>
                <% products.forEach(p => { %>
                  <tr>
                    <td><%= p.id %></td>
                    <td><%= p.name %></td>
                    <td><%= new Intl.NumberFormat('vi-VN').format(p.price) %></td>
                    <td><%= p.quantity %></td>
                    <td>
                      <div class="action-buttons">
                        <a href="/products/edit/<%= p.id %>" class="btn-edit">‚úèÔ∏è S·ª≠a</a>
                        <form action="/products/delete/<%= p.id %>" method="post" style="display: inline;" onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?');">
                          <button type="submit" class="btn-delete">üóëÔ∏è X√≥a</button>
                        </form>
                      </div>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
        <% } else { %>
          <div class="empty-state">
            <p>üì≠ Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o. H√£y th√™m s·∫£n ph·∫©m ƒë·∫ßu ti√™n!</p>
          </div>
        <% } %>
      </div>
    </div>
  </div>

  <script>
    const form = document.getElementById('productForm');
    const nameInput = document.getElementById('name');
    const priceInput = document.getElementById('price');
    const quantityInput = document.getElementById('quantity');
    const nameError = document.getElementById('nameError');
    const priceError = document.getElementById('priceError');
    const quantityError = document.getElementById('quantityError');

    // Validate on input
    nameInput.addEventListener('input', () => validateField(nameInput, nameError, validateName));
    priceInput.addEventListener('input', () => validateField(priceInput, priceError, validatePrice));
    quantityInput.addEventListener('input', () => validateField(quantityInput, quantityError, validateQuantity));

    // Validate on blur
    nameInput.addEventListener('blur', () => validateField(nameInput, nameError, validateName));
    priceInput.addEventListener('blur', () => validateField(priceInput, priceError, validatePrice));
    quantityInput.addEventListener('blur', () => validateField(quantityInput, quantityError, validateQuantity));

    function validateName() {
      const value = nameInput.value.trim();
      if (value === '') {
        nameError.textContent = 'Vui l√≤ng nh·∫≠p t√™n s·∫£n ph·∫©m';
        return false;
      }
      if (value.length < 2) {
        nameError.textContent = 'T√™n s·∫£n ph·∫©m ph·∫£i c√≥ √≠t nh·∫•t 2 k√Ω t·ª±';
        return false;
      }
      return true;
    }

    function validatePrice() {
      const value = priceInput.value.trim();
      if (value === '') {
        priceError.textContent = 'Vui l√≤ng nh·∫≠p gi√° s·∫£n ph·∫©m';
        return false;
      }
      const price = parseFloat(value);
      if (isNaN(price) || price <= 0) {
        priceError.textContent = 'Gi√° ph·∫£i l√† s·ªë d∆∞∆°ng';
        return false;
      }
      return true;
    }

    function validateQuantity() {
      const value = quantityInput.value.trim();
      if (value === '') {
        quantityError.textContent = 'Vui l√≤ng nh·∫≠p s·ªë l∆∞·ª£ng';
        return false;
      }
      const quantity = parseInt(value);
      if (isNaN(quantity) || quantity < 0 || !Number.isInteger(parseFloat(value))) {
        quantityError.textContent = 'S·ªë l∆∞·ª£ng ph·∫£i l√† s·ªë nguy√™n kh√¥ng √¢m';
        return false;
      }
      return true;
    }

    function validateField(input, errorElement, validationFunction) {
      const isValid = validationFunction();
      if (isValid) {
        input.classList.remove('error');
        errorElement.classList.remove('show');
      } else {
        input.classList.add('error');
        errorElement.classList.add('show');
      }
      return isValid;
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const isNameValid = validateField(nameInput, nameError, validateName);
      const isPriceValid = validateField(priceInput, priceError, validatePrice);
      const isQuantityValid = validateField(quantityInput, quantityError, validateQuantity);

      if (isNameValid && isPriceValid && isQuantityValid) {
        form.submit();
      } else {
        // Focus on first invalid field
        if (!isNameValid) nameInput.focus();
        else if (!isPriceValid) priceInput.focus();
        else if (!isQuantityValid) quantityInput.focus();
      }
    });
  </script>
</body>
</html>
